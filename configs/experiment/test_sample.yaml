# @package _global_
# Quick test experiment with sample data

defaults:
  - override /assets: EURUSD
  - override /data/bars: base_bars
  - override /session: base_session
  - override /labeling: triple_barrier
  - override /features: base_features
  - override /models/hmm: base_hmm
  - override /models: rf_cpu
  - override /validation: tscv
  - override /backtest: base_bt
  - override /risk: base_risk
  - override /reporting: base_report
  - override /mlflow: local
  - override /runtime: debug

experiment:
  name: "test_sample_eurusd"
  description: "Quick end-to-end test with EURUSD sample (50k ticks)"
  tags: ["test", "sample", "eurusd", "quick"]

data:
  dukascopy:
    raw_dir: "data/raw"
    filename: "EURUSD_2023_sample.parquet"
  
  bars:
    type: "tick"
    threshold: 500  # Create bar every 500 ticks (~100 bars from 50k ticks)

session:
  session_start: "00:00"
  session_end: "21:55"
  friday_end: "20:00"
  weekend_trading: false

labeling:
  triple_barrier:
    tp_ticks: 50  # Smaller TP for quicker hits
    sl_ticks: 50  # Smaller SL for quicker hits
    max_horizon_bars: 20  # Shorter max horizon
    min_horizon_bars: 5
    distance_mode: "ticks"

features:
  returns_lookbacks: [1, 5, 10]
  volatility_lookbacks: [10, 20]
  range_lookbacks: [10]
  spread_stats_lookbacks: [5]
  order_flow_lookbacks: [5, 10]

models:
  hmm:
    macro:
      enabled: true
      n_states: 3
      features: ["ret_long", "vol_long", "trend_slope", "trend_strength"]
    
    micro:
      enabled: true
      n_states: 3
      features: ["of_imbalance", "spread", "spread_change", "tick_direction"]
  
  random_forest:
    enabled: true
    params:
      n_estimators: 50  # Fewer trees for speed
      max_depth: 5
      min_samples_leaf: 5
      n_jobs: -1
      class_weight: "balanced"
    calibration:
      enabled: false  # Skip for quick test

validation:
  n_splits: 2  # Just 2 folds
  train_duration: 40  # 40 bars for training
  test_duration: 20  # 20 bars for testing
  purge_window: 5
  embargo_duration: 2

risk:
  initial_capital: 10000
  max_drawdown_pct: 0.10
  profit_target_pct: 0.10
  mc_simulations: 1000  # Fewer for speed

reporting:
  enabled: true
  output_dir: "outputs/reports"

runtime:
  log_level: "INFO"
  gpu_enabled: false

