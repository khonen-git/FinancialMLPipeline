================================================================================
CPU PROFILING RESULTS
================================================================================

         545857283 function calls (536385513 primitive calls) in 177.111 seconds

   Ordered by: cumulative time
   List reduced from 3416 to 50 due to restriction <50>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
      157    1.347    0.009  210.579    1.341 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/threading.py:323(wait)
  943/700    2.203    0.002  179.289    0.256 {method 'acquire' of '_thread.lock' objects}
      3/1    0.000    0.000  177.111  177.111 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/threading.py:1018(_bootstrap)
        1    0.000    0.000  177.097  177.097 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/threading.py:1117(join)
        1    0.000    0.000  177.067  177.067 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/threading.py:1155(_wait_for_tstate_lock)
      2/1    0.000    0.000  176.577  176.577 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/hydra/main.py:80(decorated_main)
      2/1    0.003    0.001  176.577  176.577 /home/khonen/Dev/FinancialMLPipeline/src/pipeline/main_pipeline.py:50(run_pipeline)
        1    0.000    0.000  102.824  102.824 /home/khonen/Dev/FinancialMLPipeline/src/pipeline/bar_builder.py:19(build_bars)
        1    0.037    0.037  102.823  102.823 /home/khonen/Dev/FinancialMLPipeline/src/data/bars.py:34(build_bars)
        1    0.989    0.989  102.786  102.786 /home/khonen/Dev/FinancialMLPipeline/src/data/bars.py:58(_build_tick_bars)
   275456    2.176    0.000  101.979    0.000 /home/khonen/Dev/FinancialMLPipeline/src/data/bars.py:169(_aggregate_chunk)
      191    1.400    0.007   85.635    0.448 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/queue.py:154(get)
2695226/2695222    2.389    0.000   60.905    0.000 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/pandas/core/indexing.py:1177(__getitem__)
        1    0.006    0.006   57.387   57.387 /home/khonen/Dev/FinancialMLPipeline/src/pipeline/labeler.py:20(create_labels)
  2695215    2.783    0.000   53.569    0.000 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/pandas/core/indexing.py:1720(_getitem_axis)
  2203818    1.970    0.000   36.329    0.000 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/pandas/core/series.py:6439(_reduce)
  1892805    2.315    0.000   35.844    0.000 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/pandas/core/frame.py:3994(_ixs)
  3833366    4.802    0.000   28.234    0.000 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/pandas/core/frame.py:4073(__getitem__)
1928468/1652880    1.353    0.000   23.326    0.000 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/pandas/core/nanops.py:111(f)
  1928258    0.983    0.000   19.563    0.000 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/pandas/core/nanops.py:389(new_func)
  1377292    0.937    0.000   19.210    0.000 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/pandas/core/generic.py:12427(_stat_function)
   802617    0.653    0.000   19.206    0.000 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/pandas/core/indexing.py:1757(_get_slice_axis)
  3833357    2.518    0.000   17.805    0.000 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/pandas/core/frame.py:4637(_get_item_cache)
   275531    0.148    0.000   14.680    0.000 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/pandas/core/ops/common.py:62(new_method)
   275588    0.097    0.000   14.490    0.000 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/pandas/core/series.py:6604(std)
   275473    0.099    0.000   14.458    0.000 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/pandas/core/arraylike.py:192(__sub__)
   275508    0.158    0.000   14.365    0.000 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/pandas/core/series.py:6152(_arith_method)
   275508    0.881    0.000   13.963    0.000 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/pandas/core/base.py:1380(_arith_method)
92905575/92629872    7.972    0.000   12.818    0.000 {built-in method builtins.isinstance}
   790748    4.232    0.000   12.662    0.000 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/pandas/core/internals/managers.py:977(fast_xs)
  2203846    1.417    0.000   12.298    0.000 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/pandas/core/nanops.py:253(_get_values)
   826554    0.856    0.000   11.963    0.000 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/pandas/core/nanops.py:76(_f)
   275588    0.174    0.000   11.732    0.000 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/pandas/core/generic.py:12415(std)
   275588    0.337    0.000   11.557    0.000 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/pandas/core/generic.py:12359(_stat_function_ddof)
  1101825    0.892    0.000   10.992    0.000 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/pandas/core/nanops.py:1083(reduction)
   527160    0.437    0.000   10.206    0.000 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/pandas/core/series.py:1099(_slice)
  2396002    1.814    0.000   10.084    0.000 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/pandas/core/arrays/datetimelike.py:390(__getitem__)
   802621    0.912    0.000    9.912    0.000 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/pandas/core/indexes/base.py:5437(_getitem_slice)
   275531    0.475    0.000    9.689    0.000 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/pandas/core/series.py:6222(_construct_result)
        1    0.031    0.031    8.987    8.987 /home/khonen/Dev/FinancialMLPipeline/src/labeling/triple_barrier.py:334(label_dataset)
   550928    0.182    0.000    8.952    0.000 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/pandas/core/series.py:6540(sum)
   550938    0.236    0.000    8.779    0.000 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/pandas/core/generic.py:12563(sum)
  3797490    1.665    0.000    8.562    0.000 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/pandas/core/indexes/base.py:5385(__getitem__)
   550938    0.513    0.000    8.543    0.000 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/pandas/core/generic.py:12524(_min_count_stat_function)
   550913    0.185    0.000    8.501    0.000 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/pandas/core/series.py:6530(max)
   550913    0.235    0.000    8.316    0.000 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/pandas/core/generic.py:12462(max)
275612/275598    1.210    0.000    7.915    0.000 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/pandas/core/series.py:392(__init__)
   275588    0.614    0.000    7.464    0.000 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/pandas/core/nanops.py:908(nanstd)
   550912    0.169    0.000    7.374    0.000 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/pandas/core/series.py:6520(min)
  235/234    7.306    0.031    7.334    0.031 {built-in method time.sleep}




================================================================================
TOP FUNCTIONS BY TOTAL TIME (excluding subcalls):
================================================================================
         545857283 function calls (536385513 primitive calls) in 177.111 seconds

   Ordered by: internal time
   List reduced from 3416 to 50 due to restriction <50>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
92905575/92629872    7.972    0.000   12.818    0.000 {built-in method builtins.isinstance}
  235/234    7.306    0.031    7.334    0.031 {built-in method time.sleep}
  6863946    5.978    0.000    5.978    0.000 {method 'reduce' of 'numpy.ufunc' objects}
  3833366    4.802    0.000   28.234    0.000 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/pandas/core/frame.py:4073(__getitem__)
  2971115    4.412    0.000    6.237    0.000 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/pandas/core/generic.py:6258(__finalize__)
   790748    4.232    0.000   12.662    0.000 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/pandas/core/internals/managers.py:977(fast_xs)
  8661491    3.973    0.000    5.194    0.000 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/pandas/core/generic.py:6323(__setattr__)
22740698/13826591    2.886    0.000    4.414    0.000 {built-in method builtins.len}
  2695215    2.783    0.000   53.569    0.000 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/pandas/core/indexing.py:1720(_getitem_axis)
  2971179    2.664    0.000    3.216    0.000 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/pandas/core/generic.py:281(__init__)
  3833357    2.518    0.000   17.805    0.000 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/pandas/core/frame.py:4637(_get_item_cache)
2695226/2695222    2.389    0.000   60.905    0.000 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/pandas/core/indexing.py:1177(__getitem__)
  1593354    2.345    0.000    4.511    0.000 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/pandas/core/arrays/datetimes.py:547(_box_func)
  1892805    2.315    0.000   35.844    0.000 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/pandas/core/frame.py:3994(_ixs)
  7319339    2.313    0.000    3.912    0.000 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/pandas/core/indexing.py:2801(check_dict_or_set_indexers)
  943/700    2.203    0.002  179.289    0.256 {method 'acquire' of '_thread.lock' objects}
   275456    2.176    0.000  101.979    0.000 /home/khonen/Dev/FinancialMLPipeline/src/data/bars.py:169(_aggregate_chunk)
  2204004    2.054    0.000    2.702    0.000 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/pandas/core/dtypes/missing.py:261(_isna_array)
   802685    2.032    0.000    4.225    0.000 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/pandas/core/indexes/base.py:843(_engine)
22540277/22540212    2.028    0.000    2.292    0.000 {built-in method builtins.getattr}
  1102057    2.026    0.000    3.703    0.000 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/pandas/core/internals/managers.py:1031(iget)
 12233042    2.011    0.000    4.572    0.000 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/pandas/core/dtypes/generic.py:42(_instancecheck)
  2203818    1.970    0.000   36.329    0.000 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/pandas/core/series.py:6439(_reduce)
        6    1.899    0.317    1.899    0.317 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/cuml/ensemble/randomforestclassifier.py:198(fit)
   790768    1.897    0.000    4.493    0.000 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/pandas/core/dtypes/cast.py:1444(find_common_type)
  2396002    1.814    0.000   10.084    0.000 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/pandas/core/arrays/datetimelike.py:390(__getitem__)
 12233042    1.729    0.000    2.527    0.000 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/pandas/core/dtypes/generic.py:37(_check)
  2396002    1.714    0.000    6.823    0.000 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/pandas/core/arrays/_mixins.py:278(__getitem__)
  3797490    1.665    0.000    8.562    0.000 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/pandas/core/indexes/base.py:5385(__getitem__)
   275588    1.636    0.000    3.601    0.000 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/pandas/core/nanops.py:954(nanvar)
3030468/3030460    1.420    0.000    5.765    0.000 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/pandas/core/dtypes/missing.py:184(_isna)
  2203846    1.417    0.000   12.298    0.000 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/pandas/core/nanops.py:253(_get_values)
      191    1.400    0.007   85.635    0.448 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/queue.py:154(get)
1928468/1652880    1.353    0.000   23.326    0.000 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/pandas/core/nanops.py:111(f)
      157    1.347    0.009  210.579    1.341 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/threading.py:323(wait)
  4384434    1.332    0.000    1.609    0.000 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/pandas/core/indexes/base.py:5335(__contains__)
 11382054    1.281    0.000    1.281    0.000 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/pandas/core/internals/blocks.py:1319(iget)
  2719203    1.219    0.000    1.393    0.000 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/pandas/core/indexes/base.py:3784(get_loc)
275612/275598    1.210    0.000    7.915    0.000 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/pandas/core/series.py:392(__init__)
  1593354    1.103    0.000    1.103    0.000 {method 'view' of 'numpy.generic' objects}
   275456    1.022    0.000    1.022    0.000 /home/khonen/Dev/FinancialMLPipeline/src/labeling/session_calendar.py:70(get_session_end_for_day)
   275461    1.002    0.000    7.034    0.000 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/pandas/core/generic.py:4383(_slice)
        1    0.989    0.989  102.786  102.786 /home/khonen/Dev/FinancialMLPipeline/src/data/bars.py:58(_build_tick_bars)
   527160    0.986    0.000    6.949    0.000 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/pandas/core/internals/managers.py:1993(get_slice)
  1928258    0.983    0.000   19.563    0.000 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/pandas/core/nanops.py:389(new_func)
  2695553    0.978    0.000    4.228    0.000 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/pandas/core/generic.py:342(_from_mgr)
  4648056    0.975    0.000    1.143    0.000 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/pandas/core/internals/managers.py:2023(internal_values)
  2408339    0.966    0.000    3.277    0.000 {built-in method builtins.any}
  1892805    0.965    0.000    5.273    0.000 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/pandas/core/frame.py:682(_constructor_sliced_from_mgr)
  7319388    0.964    0.000    1.410    0.000 /home/khonen/micromamba/envs/financial-ml/lib/python3.12/site-packages/pandas/core/common.py:372(apply_if_callable)




================================================================================
GPU MONITORING RESULTS
================================================================================
Average GPU Utilization: 31.9%
Peak GPU Utilization: 97.0%
Average GPU Memory: 1323 MB
Peak GPU Memory: 1713 MB
Monitoring Samples: 234
